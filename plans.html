<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-445583766"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-445583766'); 
    </script>
    
    <title>【官方公開】頂級喪葬費用方案總覽 | 中式、西式禮儀價格透明、比較表與下載 | 祥安生命</title>
    <meta name="description" content="祥安生命提供國家認證的頂級中、西式禮儀方案費用，從 NT$16.8萬起。價格公開透明，專業禮儀師全程指導，合約保證不追加費用。立即查看方案、比較表並下載報價單，感受有溫度的告別。">
    <meta name="keywords" content="喪葬費用公開, 喪葬價格透明, 中式禮儀費用, 西式禮儀方案, 基督教告別式, 佛道教喪葬契約, 祥安生命, 喪葬補助, 臨終處理">
    <link rel="canonical" href="https://24hour.台灣/Shiangan/plans.html">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" href="images/hero-plans.jpg" as="image">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style">
    <link rel="preload" href="css/style.css" as="style">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="css/style.css" media="print" onload="this.media='all'"> 
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <link rel="stylesheet" href="css/style.css">
    </noscript>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght=300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* 1. CSS 變數：高質感色彩與間距定義 */
        :root {
            --primary-color: #800020; /* 勃根地紅/酒紅 - 莊重、溫暖 */
            --accent-color: #D1A65E; /* 溫暖金色 - 尊貴、光輝 */
            --light-bg: #F8F9FA; /* 輕盈的背景 */
            --subtle-gray: #7A7A7A; /* 柔和的文字灰 */
            --price-highlight: #A6293A; /* 價格強調紅 */
            --border-radius-lg: 12px;
            --box-shadow-sm: 0 4px 15px rgba(0, 0, 0, 0.08);
            --transition-speed: 0.35s;
            --western-theme: #007bff; /* 西式主題藍 */
        }

        /* Essential Layout */
        body { margin: 0; padding: 0; font-family: 'Noto Sans TC', sans-serif; line-height: 1.6; color: #333; background-color: #fff; }
        .main-content-area { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        h2 { text-align: center; color: var(--primary-color); margin-top: 40px; margin-bottom: 35px; font-size: clamp(1.8em, 4vw, 2.2em); border-bottom: 4px double var(--accent-color); padding-bottom: 10px; font-family: 'Noto Serif TC', serif; }
        h3 { color: #4a4a4a; font-size: clamp(1.4em, 3.5vw, 1.6em); margin-top: 35px; margin-bottom: 20px; text-align: center; font-family: 'Noto Serif TC', serif; }

        /* Tab 切換 */
        .plan-tabs { display: flex; justify-content: center; margin-bottom: 50px; border-bottom: 2px solid var(--accent-color); gap: 10px; overflow-x: auto; padding-bottom: 5px; }
        .tab-button { background-color: transparent; border: none; padding: 15px 30px; font-size: clamp(1em, 3vw, 1.2em); font-weight: bold; color: var(--subtle-gray); cursor: pointer; transition: all var(--transition-speed) ease; white-space: nowrap; border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0; position: relative; }
        .tab-button.active { color: white; background-color: var(--primary-color); box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.15); border: 1px solid var(--primary-color); border-bottom: none; transform: translateY(-2px); }

        /* 方案卡片 */
        .plans-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; margin-bottom: 50px; padding-top: 20px; }
        .plan-card { background: white; border: 1px solid #e0e0e0; border-radius: var(--border-radius-lg); box-shadow: var(--box-shadow-sm); overflow: hidden; display: flex; flex-direction: column; transition: transform var(--transition-speed), box-shadow var(--transition-speed); text-align: center; position: relative; }
        .plan-header { background: linear-gradient(145deg, #F8F4EF 0%, #E8E2D7 100%); padding: 35px 20px 25px; border-bottom: 6px solid var(--accent-color); }
        .plan-price { font-size: clamp(2.5em, 7vw, 3.5em); font-weight: 900; color: var(--price-highlight); line-height: 1; margin-top: 5px; }
        .details-button { display: block; background-color: var(--accent-color); color: var(--primary-color); padding: 18px; text-decoration: none; border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg); font-weight: bold; font-size: clamp(1.0em, 3vw, 1.15em); transition: background-color var(--transition-speed), transform 0.2s; box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1); margin-top: auto; cursor: pointer; }

        /* Modal 基礎與叉叉定位 (最高配方修正) */
        .modal-overlay {
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            transition: opacity 0.3s ease;
            opacity: 0;
            overflow-y: auto; 
            backdrop-filter: blur(8px) brightness(0.7);
        }
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }
        .modal-content {
            background-color: #fff;
            position: relative;
            border-radius: 15px; 
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6); 
            max-width: 900px;
            margin: 40px auto; 
            transform: scale(0.9);
            transition: transform 0.3s ease;
            box-sizing: border-box; 
            overflow: hidden; 
        }
        .modal-header {
            background-color: var(--primary-color);
            padding: 25px 20px;
            border-radius: 15px 15px 0 0;
            font-size: 1.8em;
            color: white;
            position: relative; 
        }
        .close-btn {
            position: absolute;
            top: 15px;      /* 距離頂部 15px */
            right: 15px;    /* 距離右側 15px */
            background: none;
            border: none;
            color: white; 
            font-size: 1.8em; 
            cursor: pointer;
            padding: 5px 10px; 
            z-index: 10001; 
            transition: color 0.2s, transform 0.2s;
            line-height: 1; 
        }
        .close-btn:hover {
            color: var(--accent-color); 
            transform: rotate(90deg);
        }
        .modal-body {
            padding: 25px;
        }
        
        /* 響應式微調 */
        @media (max-width: 767px) {
            .main-content-area { padding: 0 10px; }
            .plan-tabs { justify-content: flex-start; }
            .modal-content { max-width: 95%; margin: 20px auto; }
            .close-btn { font-size: 1.5em; top: 10px; right: 10px; }
            .comparison-table-wrapper { overflow-x: auto; }
            .comparison-table th, .comparison-table td { font-size: 0.9em; padding: 8px 10px; }
        }
    </style>

    <script type="application/ld+json">
    {/* ... Schema Markup 內容保持不變 ... */}
    </script>
    <script type="application/ld+json">
    {/* ... FAQPage Markup 內容保持不變 ... */}
    </script>

</head>

<body class="js-loading">
    <header class="main-header" role="banner">
        {/* ... 導覽內容保持不變 ... */}
    </header>
    
    <main role="main">
        <section id="page-hero" class="hero-section subpage-hero" style="background-image: url('images/hero-plans.jpg'); min-height: 450px;" aria-label="喪葬費用公開方案總覽">
            {/* ... Hero 內容保持不變 ... */}
        </section>

        <section id="plan-selection" class="main-content-area" aria-labelledby="plan-selection-heading">
            <h2 id="plan-selection-heading">依循信仰與心願：禮儀方案總覽</h2>
            
            <div class="plan-tabs" role="tablist" aria-label="選擇禮儀服務方案">
                <button class="tab-button active" role="tab" id="tab-buddhist-taoist" aria-controls="content-buddhist-taoist" aria-selected="true" onclick="openPlanTab('buddhist-taoist')" tabindex="0">
                    <i class="fas fa-hand-holding-heart chinese-theme"></i> 佛道教 (中式)
                </button>
                <button class="tab-button" role="tab" id="tab-western" aria-controls="content-western" aria-selected="false" onclick="openPlanTab('western')" tabindex="-1">
                    <i class="fas fa-church western-theme"></i> 西式禮儀 (基督教/天主教)
                </button>
                <button class="tab-button" role="tab" id="tab-japen" aria-controls="content-japen" aria-selected="false" onclick="openPlanTab('japen')" tabindex="-1">
                    <i class="fas fa-globe japen-theme"></i> 日式禮儀 (創價學會等)
                </button>
            </div>

            <div class="plans-content">
                <div id="content-buddhist-taoist" class="plan-tab-content active" role="tabpanel" aria-labelledby="tab-buddhist-taoist">
                    {/* ... 內容保持不變 ... */}
                </div>

                <div id="content-western" class="plan-tab-content" role="tabpanel" aria-labelledby="tab-western" style="display:none;">
                    {/* ... 內容保持不變 ... */}
                </div>

                <div id="content-japen" class="plan-tab-content" role="tabpanel" aria-labelledby="tab-japen" style="display:none;">
                    {/* ... 內容保持不變 ... */}
                </div>
            </div>
        </section>

        <section id="custom-plan" role="region" aria-labelledby="custom-heading" class="main-content-area" style="background-color: #383838;">
             {/* ... 內容保持不變 ... */}
        </section>
    </main>
    
    <div id="modal-planA-detail" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-planA-title" onclick="closeModal(event)" tabindex="-1" aria-hidden="true">
        <div class="modal-content" role="document">
            <header class="modal-header">
                <h4 id="modal-planA-title">中式：平安心意專案 (16.8萬) - 完整細節</h4>
                <button class="close-btn" onclick="closeModal(event)" aria-label="關閉方案細節視窗" tabindex="0"><i class="fas fa-times"></i></button>
            </header>
            <div class="modal-body">
                {/* ... Modal 內容保持不變 ... */}
            </div>
        </div>
    </div>
    
    <div id="modal-planB-detail" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-planB-title" onclick="closeModal(event)" tabindex="-1" aria-hidden="true">
        <div class="modal-content" role="document">
            <header class="modal-header" style="background-color: #2980B9;">
                <h4 id="modal-planB-title">中式：精緻尊享專案 (18.8萬) - 完整細節</h4>
                <button class="close-btn" onclick="closeModal(event)" aria-label="關閉方案細節視窗" tabindex="0"><i class="fas fa-times"></i></button>
            </header>
            <div class="modal-body">
                {/* ... Modal 內容保持不變 ... */}
            </div>
        </div>
    </div>
    
    <div id="modal-planC-detail" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-planC-title" onclick="closeModal(event)" tabindex="-1" aria-hidden="true">
        <div class="modal-content" role="document">
            <header class="modal-header" style="background-color: #4a4a4a;">
                <h4 id="modal-planC-title">中式：至尊圓滿專案 (35.8萬) - 完整細節</h4>
                <button class="close-btn" onclick="closeModal(event)" aria-label="關閉方案細節視窗" tabindex="0"><i class="fas fa-times"></i></button>
            </header>
            <div class="modal-body">
                 {/* ... Modal 內容保持不變 ... */}
            </div>
        </div>
    </div>

    <div id="modal-comparison-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-comparison-title" onclick="closeModal(event)" tabindex="-1" aria-hidden="true">
        <div class="modal-content" role="document">
            <header class="modal-header" style="background-color: var(--primary-color);">
                <h4 id="modal-comparison-title"><i class="fas fa-balance-scale"></i> 佛道教三方案核心差異總比較表</h4>
                <button class="close-btn" onclick="closeModal(event)" aria-label="關閉比較表視窗" tabindex="0"><i class="fas fa-times"></i></button>
            </header>
            <div class="modal-body">
                {/* ... Modal 內容保持不變 ... */}
            </div>
        </div>
    </div>


    <footer role="contentinfo">
        {/* ... Footer 內容保持不變 ... */}
    </footer>
    
    <div class="floating-cta" aria-label="緊急聯繫方式">
        <a href="tel:+886978583699" title="24H 電話諮詢 0978-583-699"><i class="fas fa-phone"></i></a>
        <a href="https://line.me/ti/p/@yourlineid" target="_blank" rel="noopener noreferrer nofollow" title="LINE 即時諮詢"><i class="fab fa-line"></i></a>
    </div>
    
    <a href="#" class="back-to-top" aria-label="返回頂部">
        <i class="fas fa-chevron-up"></i>
    </a>


    <script>
        /**
         * 處理 Tab 方案切換的 JavaScript 函數 (保持不變)
         */
        function openPlanTab(tabName) {
            let i, tabcontent, tablinks;
            
            tabcontent = document.getElementsByClassName("plan-tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove("active");
                document.getElementById("tab-" + tabcontent[i].id.split('-')[1])?.setAttribute('aria-selected', 'false');
            }
            
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
                tablinks[i].setAttribute('tabindex', '-1'); 
            }
            
            const contentId = "content-" + tabName;
            const tabId = "tab-" + tabName;

            const contentElement = document.getElementById(contentId);
            const tabElement = document.getElementById(tabId);

            if (contentElement) {
                contentElement.style.display = "block";
                contentElement.classList.add("active");
            }
            if (tabElement) {
                tabElement.classList.add("active");
                tabElement.setAttribute('aria-selected', 'true');
                tabElement.setAttribute('tabindex', '0'); 
            }
        }

        let focusedElementBeforeModal; // 用於儲存 Modal 開啟前的焦點元素

        /** 核心 Modal 開啟函數 (A11y 強化：焦點鎖定與還原) */
        function openModal(modalId) {
            const modal = document.getElementById('modal-' + modalId);
            if (modal) {
                focusedElementBeforeModal = document.activeElement; // 記錄開啟前的焦點
                
                document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                modal.scrollTop = 0; 
                modal.setAttribute('aria-hidden', 'false');
                
                // 讓 Modal 自身獲得焦點，然後將焦點轉移到關閉按鈕
                modal.focus();
                const closeButton = modal.querySelector('.close-btn');
                if (closeButton) {
                    closeButton.focus(); 
                }
                
                // 啟用 Modal 內的 Tab 鍵循環 (Focus Trap)
                modal.addEventListener('keydown', handleModalKeydown);
            }
        }

        /** 核心 Modal 關閉函數 (A11y 強化：移除焦點鎖定，還原焦點) */
        function closeModal(event) {
            // 判斷是否為點擊事件，如果是，則檢查點擊目標
            if (event.type === 'click' && !event.target.classList.contains('modal-overlay') && !event.target.closest('.close-btn')) {
                return;
            }

            const activeModal = document.querySelector('.modal-overlay.active');
            if (activeModal) {
                activeModal.classList.remove('active');
                activeModal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = 'auto';
                
                // 移除事件監聽
                activeModal.removeEventListener('keydown', handleModalKeydown);

                // 將焦點還原到開啟 Modal 的元素
                if (focusedElementBeforeModal) {
                    focusedElementBeforeModal.focus();
                }
            }
        }
        
        /** 處理 Modal 內的 Tab 鍵循環 (Focus Trap) */
        function handleModalKeydown(e) {
            const modal = e.currentTarget;

            // 處理 ESC 鍵關閉
            if (e.key === 'Escape') {
                closeModal(e);
                return;
            }

            // 處理 Tab 鍵循環 (Focus Trap)
            if (e.key === 'Tab') {
                // 選取所有 Modal 內的可焦點元素 (修正：排除 Modal 本身的 tabindex="-1")
                const focusableElements = modal.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])');

                // 過濾掉不可見或被隱藏的元素
                const visibleFocusableElements = Array.from(focusableElements).filter(el => 
                    el.offsetWidth > 0 || el.offsetHeight > 0 || el === modal.querySelector('.close-btn')
                );

                if (visibleFocusableElements.length === 0) return;

                const first = visibleFocusableElements[0];
                const last = visibleFocusableElements[visibleFocusableElements.length - 1];
                
                if (e.shiftKey) { // Shift + Tab (從第一個跳到最後一個)
                    if (document.activeElement === first) {
                        last.focus();
                        e.preventDefault();
                    }
                } else { // Tab (從最後一個跳到第一個)
                    if (document.activeElement === last) {
                        first.focus();
                        e.preventDefault();
                    }
                }
            }
        }

        /**
         * 頁面加載後，初始化 Tab 顯示並處理錨點滾動 (最終邏輯)
         */
        document.addEventListener('DOMContentLoaded', (event) => {
            const hash = window.location.hash.substring(1); 
            
            let defaultTab = 'buddhist-taoist';
            let targetCardId = null;
            let modalToOpen = null; 

            const hashToCardMap = {
                'eighty-eight': { card: 'plan-168', modal: 'planA-detail' }, 
                'eleven-eight': { card: 'plan-188', modal: 'planB-detail' }, 
                'seventeen-eight': { card: 'plan-358', modal: 'planC-detail' }, 
            };

            // 1. 處理 Tab 切換與 Modal 選擇
            if (hash === 'west') {
                defaultTab = 'western';
            } else if (hash === 'japen') {
                defaultTab = 'japen';
            } else if (hashToCardMap[hash]) {
                defaultTab = 'buddhist-taoist';
                targetCardId = hashToCardMap[hash].card;
                modalToOpen = hashToCardMap[hash].modal; 
            } else if (hash === 'comparison') {
                 defaultTab = 'buddhist-taoist';
                 modalToOpen = 'comparison-modal'; 
            }
            
            openPlanTab(defaultTab);

            // 2. 處理滾動與自動開啟 Modal
            const planSelection = document.getElementById('plan-selection');

            if (planSelection) {
                planSelection.scrollIntoView({ behavior: 'smooth', block: 'start' }); 
                
                setTimeout(() => {
                    if (targetCardId) {
                        const targetElement = document.getElementById(targetCardId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    } 
                    
                    if (modalToOpen) {
                         setTimeout(() => {
                            openModal(modalToOpen);
                         }, targetCardId ? 500 : 0); 
                    }
                }, 100); 
            }
            
            // 3. 通用腳本與 DOM 準備完成
            document.getElementById('current-year').textContent = new Date().getFullYear();
            document.body.classList.remove('js-loading');

            // 4. Back to Top 按鈕邏輯
            const backToTopButton = document.querySelector('.back-to-top');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) { // 捲動超過 300px 顯示按鈕
                    backToTopButton.classList.add('visible');
                } else {
                    backToTopButton.classList.remove('visible');
                }
            });
            backToTopButton.addEventListener('click', (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        
        // 5. 監聽 Modal ESC 鍵 (全域)
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                // 這裡的 closeModal 會處理是否有 active Modal
                closeModal(event);
            }
        });

    </script>
</body>
</html>
